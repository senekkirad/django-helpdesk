


{% extends 'base.html' %}

{% block 'title' %}Tickets{% endblock 'title' %}

{% block 'content' %}


  <div class="container my-5">

    {% if messages %}
        {% for message in messages %}
            <p class="alert alert-info">
                {{ message }}
            </p>
        {% endfor %}
    {% endif %}

    

    
      <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
        <a  href="{% url 'list_tickets' %}?status={{ 'all' }}"  class="btn btn-secondary" >Tous</a>
        <a href="{% url 'list_tickets' %}?status={{ 'unassigned' }}" type="button" class="btn btn-secondary">Non assignés</a>
        <a href="{% url 'list_tickets' %}?status={{ 'pending' }}" type="button" class="btn btn-secondary">En cours</a>
        <a href="{% url 'list_tickets' %}?status={{ 'resolved' }}" type="button" class="btn btn-secondary">Résolus</a>
      </div>
      
      <!-- {% for ticket in tickets %}
     <div class="row my-4">
       <div class="col-lg-12 col-xl-12 mx-auto">
           <div class="card card-signin flex-row justify-content-between align-items-center py-2 px-4">
               <div class="ticket_left">
                   <h5><a href="{% url 'ticket_details' ticket.id %}"> {{ ticket.subject }}</a></h5>
                   <h6>Created on {{ ticket.created_on.date }} at {{ ticket.created_on.time}} Agent: {{ ticket.accepted_by }}</h6>
               </div>
               <div class="ticket_right">
                   {% if ticket.status == 1 %}
                        <h6 class="btn btn-secondary disabled">Unassigned</h6>
                   {% endif %}
                   {% if ticket.status == 2 %}
                        <h6 class="btn btn-warning disabled">Pending</h6>
                   {% endif %}
                   {% if ticket.status == 3 %}
                        <h6 class="btn btn-success disabled">Resolved</h6>
                   {% endif %}
                   <a href="{% url 'ticket_close' ticket.id %}"><h6 class="btn btn-danger">Close</h6></a>
               </div>
           </div>
        </div>
        
      </div>
      {% endfor %} -->



      <div class="card card-signin flex-row justify-content-between align-items-center py-4" style="margin-top: 40px; ">
        <div class="col">
            <div class="dash-table ">
                <div class="table-responsive table-responsive-xl ">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th class="text-start">Objet</th>
                                <th class="text-center">Priorité</th>
                                <th class="text-center">Status</th>
                                <th>Date de création</th>
                                <th class="text-end">Voir détails</th>
                            </tr>
                        </thead>
                        <tbody class="align-middle">
                            {% for ticket in tickets %}
                                <tr>
                                    <td>
                                        <a href="{% url 'ticket_details' ticket.id %}">#00{{ticket.id}}</a>
                                    </td>
                                    <td class="text-start">
                                       
                                            {{ticket.subject}}
                                        
                                    </td>
                                    <td class="text-center">
                                        {% if ticket.priority == 1 %}
                                            Urgent
                                        {% endif %}
                                        {% if ticket.priority == 2 %}
                                            Haut
                                        {% endif %}
                                        {% if ticket.priority == 3 %}
                                            Normale
                                        {% endif %}
                                        {% if ticket.priority == 4 %}
                                            Faible
                                        {% endif %}
                                    </td>
                                    <td class="text-center">
                                        {% if ticket.status == 1 %}
                                        <h6 class="btn btn-secondary disabled">Non assigné</h6>
                                        {% endif %}
                                        {% if ticket.status == 2 %}
                                                <h6 class="btn btn-warning disabled">En cours</h6>
                                        {% endif %}
                                        {% if ticket.status == 3 %}
                                                <h6 class="btn btn-success disabled">Résolu</h6>
                                        {% endif %}
                                        
                                    </td>
                                    <td>{{ticket.created_on|date:"d-m-y à H:i"}}</td>
                                    <td class="text-end">
                                        <a href="{% url 'ticket_details' ticket.id %}" class="btn btn-secondary"><i class="fa fa-eye"></i></a>
                                    </td>
                                </tr>
                                 
                            {% endfor %}   
                        </tbody>
                    </table>
                </div>
            </div>
              
          </div>
      </div>
     
  </div>
 
{% endblock 'content' %}